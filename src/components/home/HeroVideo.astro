---
import Button from "../common/Button.astro";
import Section from "../common/Section.astro";
import TextBlock from "../common/TextBlock.astro";

const { subtitle, title, description, buttonText, videoSrc } = Astro.props;
---

<Section
  padding="large"
  width="full"
  height="auto"
  id="experience-section"
  animation="parallax"
  class="relative overflow-hidden"
>
  <div class="absolute inset-0 w-full h-full parallax-container">
    <video
      class="object-cover w-full h-100 parallax-video"
      autoplay
      loop
      muted
      playsinline
      poster="/public/assets/img/senior_couple_walking_autumn.webp"
    >
      <source src={videoSrc} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </div>
  <div
    class="relative z-10 text-center lg:text-left py-16 sm:py-24 lg:py-48 flex flex-col lg:flex-row lg:items-center"
  >
    <div class="lg:w-1/2 w-full px-4">
      <TextBlock
        subtitle={subtitle}
        title={title}
        description={description}
        alignment="left"
        textColor="text-deep-blue"
      />
      
      <div
        class="flex flex-col space-y-4 sm:flex-row sm:justify-center lg:justify-start sm:space-y-0"
      >
        <Button variant="primary" size="medium" class="mx-auto sm:mx-0 lg:ml-8">
          {buttonText}
        </Button>
      </div>
    </div>
    <div class="hidden lg:block lg:w-1/2"></div>
  </div>
</Section>

<style>
  .parallax-container {
    clip: rect(0, auto, auto, 0);
  }

  .parallax-video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    will-change: transform;
    object-fit: cover;
  }

  @media (prefers-reduced-motion: reduce) {
    .parallax-video {
      position: absolute;
    }
  }
</style>

<script>
  document.addEventListener('astro:page-load', () => {
    const video = document.querySelector('.parallax-video') as HTMLVideoElement;
    if (video) {
      video.play().catch(error => {
        console.error("Auto-play was prevented:", error);
        // Puedes agregar aquí una lógica alternativa si el auto-play falla
      });
    }
  });
</script>